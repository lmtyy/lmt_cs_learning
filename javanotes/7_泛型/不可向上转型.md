# Java中子类泛型不可向上转型的解释

在Java中，子类泛型不可向上转型是指泛型类型参数在继承关系上不保持协变（covariant）的特性。这是Java泛型的一个重要特性，称为"泛型不变性"（Generic Invariance）。

## 基本概念

假设有以下类层次结构：
```java
class Fruit {}
class Apple extends Fruit {}
class Orange extends Fruit {}
```

## 为什么子类泛型不可向上转型

对于泛型容器，即使类型参数有继承关系，容器本身也没有继承关系：

```java
List<Apple> apples = new ArrayList<>();
List<Fruit> fruits = apples;  // 编译错误！
```

虽然`Apple`是`Fruit`的子类，但`List<Apple>`并不是`List<Fruit>`的子类，这种转换是不允许的。

## 原因

Java设计者这样设计是为了保证类型安全。如果允许这样的转换：

```java
List<Apple> apples = new ArrayList<>();
List<Fruit> fruits = apples;  // 假设允许
fruits.add(new Orange());     // 这会破坏原始List<Apple>的类型安全
Apple apple = apples.get(0);  // 这里会得到Orange对象，导致运行时错误
```

## 解决方案

如果需要这种灵活性，可以使用通配符：

1. **上界通配符**（协变）：
```java
List<? extends Fruit> fruits = new ArrayList<Apple>();  // 允许
// 可以安全地读取，但不能写入（除了null）
```

2. **下界通配符**（逆变）：
```java
List<? super Apple> apples = new ArrayList<Fruit>();  // 允许
// 可以安全地写入Apple及其子类，但读取时只能作为Object
```

这种设计是Java泛型的"PECS"原则（Producer-Extends, Consumer-Super）的基础。