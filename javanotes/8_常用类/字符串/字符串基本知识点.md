# Java 字符串类知识点总结

Java中的字符串处理主要通过`String`、`StringBuilder`和`StringBuffer`这三个类来实现。以下是这些类的核心知识点：

## 1. String类

### 基本特性
- **不可变性**：String对象一旦创建就不能被修改，任何修改操作都会返回一个新的String对象
- **存储方式**：Java 9之后，String内部使用`byte[]`存储字符，并带有编码标记字段
- **字符串常量池**：字符串字面量存储在常量池中，相同的字面量会指向同一个对象

### 创建方式
```java
String str1 = "Hello";  // 字面量方式，使用常量池
String str2 = new String("Hello");  // 新建对象
char[] chars = {'H','e','l','l','o'};
String str3 = new String(chars);  // 通过字符数组创建
```

### 常用方法
- **长度相关**：
  - `length()`：返回字符串长度
  - `isEmpty()`：判断是否为空字符串

- **比较相关**：
  - `equals(Object obj)`：内容比较
  - `equalsIgnoreCase(String str)`：忽略大小写比较
  - `compareTo(String str)`：字典序比较
  - `contentEquals(CharSequence cs)`：与任意字符序列比较

- **查找相关**：
  - `charAt(int index)`：获取指定位置字符
  - `indexOf(int ch)`：查找字符首次出现位置
  - `lastIndexOf(int ch)`：查找字符最后出现位置
  - `contains(CharSequence s)`：判断是否包含子串
  - `startsWith(String prefix)`：判断是否以指定前缀开头
  - `endsWith(String suffix)`：判断是否以指定后缀结尾

- **子串操作**：
  - `substring(int beginIndex)`：获取子串
  - `substring(int beginIndex, int endIndex)`：获取指定范围的子串

- **转换相关**：
  - `toLowerCase()`：转换为小写
  - `toUpperCase()`：转换为大写
  - `toCharArray()`：转换为字符数组
  - `valueOf(各种基本类型)`：将基本类型转换为字符串

- **替换修改**：
  - `replace(char old, char new)`：字符替换
  - `replace(CharSequence target, CharSequence replacement)`：字符串替换
  - `replaceAll(String regex, String replacement)`：正则替换
  - `replaceFirst(String regex, String replacement)`：替换第一个匹配项

- **拆分连接**：
  - `split(String regex)`：按正则拆分字符串
  - `join(CharSequence delimiter, CharSequence... elements)`：连接多个字符串

- **去除空白**：
  - `trim()`：去除首尾空白(包括空格、制表符等)
  - `strip()`：Java 11新增，更严格的空白去除(支持Unicode空白字符)

## 2. StringBuilder类

### 特点
- **可变性**：内容可以修改，不会创建新对象
- **非线程安全**：性能更高，但不适合多线程环境
- **初始容量**：默认16字符，可自动扩容

### 常用方法
```java
StringBuilder sb = new StringBuilder();
sb.append("Hello");  // 追加内容
sb.insert(5, " World");  // 插入内容
sb.delete(5, 11);  // 删除内容
sb.reverse();  // 反转字符串
sb.setCharAt(0, 'h');  // 设置指定位置字符
int capacity = sb.capacity();  // 获取当前容量
sb.ensureCapacity(50);  // 确保最小容量
```

## 3. StringBuffer类

### 特点
- **可变性**：内容可以修改
- **线程安全**：方法都是同步的(synchronized)，适合多线程环境
- 方法与StringBuilder基本相同，但性能略低

## 4. 字符串比较注意事项

```java
String s1 = "Hello";
String s2 = "Hello";
String s3 = new String("Hello");

System.out.println(s1 == s2);  // true，指向常量池同一对象
System.out.println(s1 == s3);  // false，s3是新创建的对象
System.out.println(s1.equals(s3));  // true，内容相同
```

## 5. 性能考虑

- **频繁修改字符串**：使用StringBuilder(单线程)或StringBuffer(多线程)
- **字符串拼接**：编译器会将`+`优化为StringBuilder，但在循环中仍需显式使用StringBuilder
- **内存使用**：大量字符串操作时注意String的不可变性带来的内存开销

## 6. Java 8之后的改进

- **Java 9**：String内部改用`byte[]`存储，节省内存空间
- **Java 11**：
  - 新增`strip()`、`stripLeading()`、`stripTrailing()`方法
  - 新增`isBlank()`方法判断空白字符串
  - 新增`repeat(int count)`方法重复字符串
  - 新增`lines()`方法按行分割为Stream

## 7. 最佳实践

1. 优先使用字符串字面量方式创建字符串
2. 循环内字符串拼接使用StringBuilder
3. 多线程环境下使用StringBuffer
4. 使用equals()而不是==比较字符串内容
5. 注意字符串编码问题，特别是IO操作时

这些是Java字符串处理的核心知识点，掌握这些内容可以高效地进行字符串操作。