# Java 字符串计算操作详解

Java 中的字符串计算操作包括字符串连接、与其他数据类型的转换、格式化等多种操作。以下是全面的字符串计算操作指南：

## 一、字符串连接操作

### 1. 基本连接方式
```java
// 使用 + 运算符
String s1 = "Hello" + " " + "World";  // 编译器优化为"Hello World"

// 使用 concat() 方法
String s2 = "Hello".concat(" World");

// 运行时连接（产生临时StringBuilder）
String s3 = s1 + 123 + true;
```

### 2. 性能比较
- **少量连接**：`+` 运算符（编译器会优化）
- **大量/循环连接**：`StringBuilder` 更高效
```java
StringBuilder sb = new StringBuilder();
for (int i = 0; i < 100; i++) {
    sb.append(i);
}
String result = sb.toString();
```

## 二、与其他数据类型的转换

### 1. 基本类型 → 字符串
```java
// 推荐方式
String s1 = String.valueOf(123);     // "123"
String s2 = String.valueOf(3.14);    // "3.14"
String s3 = String.valueOf(true);    // "true"

// 其他方式
String s4 = 123 + "";                // 性能较差
String s5 = Integer.toString(123);   // 与valueOf等效
```

### 2. 字符串 → 基本类型
```java
int i = Integer.parseInt("123");
double d = Double.parseDouble("3.14");
boolean b = Boolean.parseBoolean("true");

// 处理异常情况
try {
    int num = Integer.parseInt("123a"); // 抛出NumberFormatException
} catch (NumberFormatException e) {
    // 处理异常
}
```

### 3. 字符数组 ↔ 字符串
```java
// 字符数组 → 字符串
char[] chars = {'H','e','l','l','o'};
String s1 = new String(chars);       // "Hello"
String s2 = String.valueOf(chars);   // "Hello"

// 字符串 → 字符数组
char[] charArray = "Hello".toCharArray();
```

## 三、格式化操作

### 1. String.format()
```java
String s = String.format("姓名: %s, 年龄: %d, 成绩: %.2f", "张三", 20, 85.567);
// 结果: "姓名: 张三, 年龄: 20, 成绩: 85.57"
```

### 2. 格式化符号
| 符号 | 说明               | 示例                     |
|------|--------------------|--------------------------|
| %s   | 字符串             | String.format("%s", "Hi")|
| %d   | 十进制整数         | String.format("%d", 100) |
| %f   | 浮点数             | String.format("%.2f", 3.1415)|
| %n   | 换行符             | String.format("Line1%nLine2")|
| %%   | 百分号             | String.format("%d%%", 50)|

## 四、数值计算与字符串

### 1. 数值计算后再转字符串
```java
int a = 10, b = 20;
String result = "结果: " + (a + b);  // 注意括号优先级
// 结果: "结果: 30"
```

### 2. 大数计算
```java
BigInteger bigInt = new BigInteger("12345678901234567890");
BigDecimal bigDec = new BigDecimal("1234567890.1234567890");

String s1 = bigInt.add(new BigInteger("1")).toString();
String s2 = bigDec.multiply(new BigDecimal("2")).toString();
```

## 五、字符串比较操作

### 1. 内容比较
```java
// 区分大小写
boolean b1 = "Hello".equals("hello");  // false

// 不区分大小写
boolean b2 = "Hello".equalsIgnoreCase("hello");  // true
```

### 2. 比较顺序
```java
int diff = "apple".compareTo("banana");  // 返回负数(a在b前)
int diff2 = "zoo".compareTo("apple");    // 返回正数(z在a后)
```

## 六、实用计算操作

### 1. 字符串长度
```java
int len = "Hello".length();  // 5
```

### 2. 查找操作
```java
int index = "Hello".indexOf('e');  // 1
boolean contains = "Hello".contains("ell");  // true
```

### 3. 提取子串
```java
String sub = "Hello World".substring(6);    // "World"
String sub2 = "Hello World".substring(0, 5); // "Hello"
```

## 七、性能注意事项

1. **避免循环中使用`+`连接字符串**：
   ```java
   // 不好
   String result = "";
   for(int i=0; i<100; i++) {
       result += i;  // 每次循环创建新StringBuilder和String
   }
   
   // 好
   StringBuilder sb = new StringBuilder();
   for(int i=0; i<100; i++) {
       sb.append(i);
   }
   String result = sb.toString();
   ```

2. **使用StringJoiner简化拼接**：
   ```java
   StringJoiner sj = new StringJoiner(", ", "[", "]");
   sj.add("Apple").add("Orange").add("Banana");
   String fruits = sj.toString();  // "[Apple, Orange, Banana]"
   ```

3. **文本块(Java 15+)处理多行字符串**：
   ```java
   String html = """
       <html>
           <body>
               <p>Hello, World!</p>
           </body>
       </html>
       """;
   ```

掌握这些字符串计算操作可以帮助您编写更高效、更健壮的Java代码。根据具体场景选择合适的操作方法，特别是在性能敏感的场景中要注意字符串操作的效率。