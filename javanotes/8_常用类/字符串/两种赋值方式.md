# Java String类的两种构造方法区别

在Java中，String类有两种主要的构造方式，它们在内存分配和行为上有重要区别：

## 1. 字面量方式（直接赋值）

```java
String str1 = "Hello";
```

**特点：**
- 使用字符串常量池（String Pool）
- JVM会首先检查常量池中是否已存在相同内容的字符串
  - 如果存在，则直接返回常量池中的引用
  - 如果不存在，则在常量池中创建新字符串
- 所有相同字面量的字符串变量都指向同一个内存地址
- 更高效，节省内存

**示例：**
```java
String a = "Hello";
String b = "Hello";
System.out.println(a == b); // 输出true，因为指向常量池中的同一个对象
```

## 2. new关键字方式

```java
String str2 = new String("Hello");
```

**特点：**
- 强制在堆内存中创建新的String对象
- 无论常量池中是否存在相同内容，都会创建新对象
- 相同内容的new String()会创建不同的对象
- 性能较低，占用更多内存

**示例：**
```java
String c = new String("Hello");
String d = new String("Hello");
System.out.println(c == d); // 输出false，因为是两个不同的对象
System.out.println(c.equals(d)); // 输出true，内容相同
```

## 内存结构对比

```
字符串常量池 (方法区)
+-----------+     堆内存
| "Hello"  |    +-------------+
+---+------+    | String对象1 |
    |           | value -> ---+---> "Hello" (常量池)
    |           +-------------+
    |           +-------------+
    +---------->| String对象2 |
                | value -> ---+---> "Hello" (常量池)
                +-------------+
```

## 重要区别总结

| 特性                | 字面量方式              | new关键字方式          |
|---------------------|------------------------|-----------------------|
| 内存位置            | 字符串常量池            | 堆内存                |
| 对象复用            | 相同内容复用同一对象    | 总是创建新对象        |
| 内存效率            | 高                     | 低                    |
| 创建方式            | 隐式                   | 显式                  |
| ==比较结果(相同内容)| true                   | false                 |
| 适用场景            | 大多数情况推荐使用      | 需要明确新对象时使用  |

## 特殊方法：intern()

可以通过`intern()`方法将new创建的字符串放入常量池：

```java
String e = new String("Hello").intern();
String f = "Hello";
System.out.println(e == f); // 输出true
```

**intern()方法行为：**
- 如果常量池中已有相同字符串，返回池中的引用
- 如果没有，则将字符串添加到池中并返回引用

## 最佳实践建议

1. **优先使用字面量方式**：更高效、更节省内存
2. **避免在循环中使用new String()**：会导致大量重复对象创建
3. **需要明确新对象时才使用new**：如需要隔离修改等情况
4. **比较字符串内容总是用equals()**：而不是==运算符

理解这两种构造方式的区别对于编写高效、正确的Java程序非常重要，特别是在处理大量字符串操作时。