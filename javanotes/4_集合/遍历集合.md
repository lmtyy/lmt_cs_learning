# Java 集合遍历的多种方式

在 Java 中，遍历集合有多种方法，每种方法适用于不同的场景。以下是常见的集合遍历方式：

## 1. 基本遍历方法

### 1.1 for 循环 (适用于 List)

```java
List<String> list = new ArrayList<>();
list.add("Apple");
list.add("Banana");
list.add("Orange");

for (int i = 0; i < list.size(); i++) {
    String item = list.get(i);
    System.out.println(item);
}
```

**特点**：
- 只适用于 `List` 这种支持随机访问的集合
- 可以通过索引访问元素
- 性能较好（特别是对 `ArrayList`）

### 1.2 增强 for 循环 (for-each)

```java
for (String item : list) {
    System.out.println(item);
}
```

**特点**：
- 适用于所有实现了 `Iterable` 接口的集合
- 语法简洁
- 不能获取当前元素的索引

## 2. 使用迭代器 (Iterator)

### 2.1 基本迭代器

```java
Iterator<String> iterator = list.iterator();
while (iterator.hasNext()) {
    String item = iterator.next();
    System.out.println(item);
}
```

### 2.2 使用 ListIterator (仅适用于 List)

```java
ListIterator<String> listIterator = list.listIterator();
while (listIterator.hasNext()) {
    String item = listIterator.next();
    int index = listIterator.previousIndex(); // 获取前一个索引
    System.out.println(index + ": " + item);
}
```

**特点**：
- 可以双向遍历（`hasPrevious()`, `previous()`）
- 可以获取元素索引
- 可以在遍历时修改集合

## 3. Java 8+ 新特性

### 3.1 forEach() 方法

```java
list.forEach(item -> System.out.println(item));

// 方法引用写法
list.forEach(System.out::println);
```

### 3.2 Stream API

```java
list.stream()
    .filter(item -> item.startsWith("A"))
    .map(String::toUpperCase)
    .forEach(System.out::println);
```

**特点**：
- 支持函数式编程风格
- 可以链式调用各种操作（filter, map, sorted 等）
- 可以进行并行处理（`parallelStream()`）

## 4. 遍历 Map 集合

Map 的遍历方式略有不同：

### 4.1 遍历键值对

```java
Map<String, Integer> map = new HashMap<>();
map.put("Apple", 10);
map.put("Banana", 20);

// 方法1：遍历EntrySet
for (Map.Entry<String, Integer> entry : map.entrySet()) {
    System.out.println(entry.getKey() + ": " + entry.getValue());
}

// 方法2：Java 8 forEach
map.forEach((key, value) -> System.out.println(key + ": " + value));
```

### 4.2 单独遍历键或值

```java
// 遍历键
for (String key : map.keySet()) {
    System.out.println(key);
}

// 遍历值
for (Integer value : map.values()) {
    System.out.println(value);
}
```

## 5. 遍历时的注意事项

1. **并发修改异常**：
   - 不要在增强 for 循环或迭代器遍历时直接修改集合（使用 `remove()` 等方法）
   - 可以使用迭代器的 `remove()` 方法安全删除元素

   ```java
   Iterator<String> it = list.iterator();
   while (it.hasNext()) {
       String item = it.next();
       if (item.equals("Banana")) {
           it.remove(); // 安全删除
       }
   }
   ```

2. **性能考虑**：
   - 对 `ArrayList`，for 循环性能最好
   - 对 `LinkedList`，迭代器性能最好
   - 大数据量时考虑使用 `parallelStream()`

3. **空集合处理**：
   - 遍历前最好检查集合是否为 null
   - 可以使用 `Collections.emptyList()` 代替 null

## 6. 遍历方式选择指南

| 遍历方式 | 适用场景 | 优点 | 缺点 |
|---------|---------|------|------|
| for循环 | 需要索引/ArrayList | 性能好 | 只支持List |
| for-each | 简单遍历 | 语法简洁 | 不能修改集合 |
| Iterator | 需要删除元素 | 安全删除 | 语法稍复杂 |
| forEach() | Java8+简单遍历 | 简洁 | 不能使用break/return |
| Stream API | 复杂数据处理 | 函数式风格 | 性能开销 |

根据具体需求选择合适的遍历方式，大多数情况下增强 for 循环或 forEach() 方法是最简洁的选择。