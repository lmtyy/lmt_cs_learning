## import

`import`语句是Python用来导入模块和包的关键机制。通过`import`，你可以调用其他Python文件中的函数、类、变量，实现**代码复用和模块化**。

---

### 一、基础：什么是模块和包？

- **模块（module）**：一个以`.py`结尾的Python文件，包含变量、函数、类等。
- **包（package）**：包含`__init__.py`文件的文件夹，可以包含多个模块和子包。

---

### 二、import语法及使用

#### 1. 导入整个模块

```python
import module_name
```

使用时需要加模块名前缀：

```python
import math
print(math.sqrt(16))  # 4.0
```

---

#### 2. 导入模块中的指定成员

```python
from module_name import name1, name2, ...
```

示例：

```python
from math import sqrt, pi
print(sqrt(25))  # 5.0
print(pi)        # 3.141592653589793
```

---

#### 3. 导入模块所有成员（不推荐）

```python
from module_name import *
```

- 会将模块中除了以`_`开头的所有公开成员导入到当前命名空间。
- 容易导致命名冲突，不推荐使用。

---

#### 4. 模块起别名

为模块或成员起别名，简化名称或避免冲突。

```python
import module_name as alias
from module_name import name as alias
```

示例：

```python
import numpy as np
from math import sqrt as square_root

print(np.array([1, 2, 3]))
print(square_root(9))
```

---

### 三、import的工作机制

1. **查找模块**

Python在执行`import`时，会根据以下顺序查找模块：

- 当前执行脚本所在目录
- 环境变量`PYTHONPATH`中的目录
- Python标准库目录
- 已安装第三方包目录

所有这些目录组合成一个模块搜索路径列表，在Python中通过`sys.path`查看：

```python
import sys
print(sys.path)
```

---

2. **加载模块**

- 如果模块已经加载过，则直接使用已加载模块，不重复加载。
- 否则会将模块文件字节码编译成`.pyc`文件（存于`__pycache__`目录），然后加载。

---

3. **模块缓存**

- 系统中已加载的模块都会被缓存到`sys.modules`字典中。
- 重复导入同一个模块时，直接从缓存中获取，提高效率。

---

### 四、包的导入

- 使用包时使用点号`.`表示多层目录。

```python
import package.subpackage.module
from package.subpackage import module
```

- `__init__.py`文件用于标识该目录是包，可以为空或者定义包的初始化代码。

---

### 五、其他import相关用法

#### 1. 动态导入（`importlib`模块）

```python
import importlib

mod = importlib.import_module('math')
print(mod.sqrt(16))  # 4.0
```

#### 2. 延迟导入

把`import`语句放在函数内部等位置，避免程序启动时加载，提升启动速度。

---

#### 3. reload模块

Python3中，用于重新加载已加载模块。

```python
import importlib
importlib.reload(module_name)
```

---

### 六、常见使用误区和注意点

- 循环导入（互相导入的两个模块）可能导致导入失败，需调整设计。
- 使用`from module import *`容易污染命名空间。
- 用别名时避免与内置函数或变量重名。
- 包目录必须有`__init__.py`（Python 3.3以后有命名空间包可以无此文件，但习惯保留）。

---

### 七、示例综合演示

```python
# math_demo.py
import math
from math import sin, cos as cosine

print(math.pi)
print(sin(math.pi / 2))
print(cosine(0))
```

运行：

```
3.141592653589793
1.0
1.0
```

---

### 八、总结

| 用法                               | 说明                              | 示例                               |
| ---------------------------------- | --------------------------------- | ---------------------------------- |
| `import module`                    | 导入整个模块，访问用`module.name` | `import math`，`math.sqrt(4)`      |
| `from module import name`          | 导入模块指定成员，直接使用`name`  | `from math import sqrt`，`sqrt(4)` |
| `from module import *`             | 导入模块所有公开成员（不推荐）    | `from math import *`               |
| `import module as alias`           | 导入模块并起别名                  | `import numpy as np`               |
| `from module import name as alias` | 导入成员并起别名                  | `from math import sqrt as sqr`     |
| 动态导入                           | 运行时按字符串导入模块            | `importlib.import_module('math')`  |
| 包导入                             | 使用点号访问子模块                | `import package.subpackage.module` |

---
